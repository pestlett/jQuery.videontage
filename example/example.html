<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
		Remove this if you use the .htaccess -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<title>jQuery.videontage Example</title>

		<script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
		<script type="text/javascript" src="imagemaps/cutts_image_map.json"></script>
		<script type="text/javascript" src="../jquery.videontage.js"></script>
		<link rel="stylesheet" href="style/default.css" type="text/css">
	</head>
	<body>
		<div>
				<canvas width="640" height="360">
					<video id="myVideo" width="640" height="360" controls="true">
						<source src="videos/cutts.mp4" type="video/mp4"></source>
					</video>
				</canvas>
				<div>
					<button id="play" disabled>Play</button>
					<button id="stop">Stop</button>
					<button id="update">Update</button>
				</div>
				<div>
					<input type='text' id='rows' value='16'>
					<input type='text' id='cols' value='16'>
				</div>
				<div id="tracker"><div id="loader"></div></div>
				<div id="loading-message"></div>
		</div>
		<script>
			$(document).ready(function(){
				var video = $("#myVideo");
				$("#play").click(function() {
					video.get(0).play();
				});

				$("#stop").click(function() {
					video.get(0).pause();
				});

				$("#update").click(function() {
					var rows = $('input#rows').val();
					var cols = $('input#cols').val();
					var data = { rows: rows, cols: cols };
					$('canvas').videontage('update', data);
				})

				$('canvas').videontage({
					imagePath: 'img/cutts/',
					imageMap: cuttsMap,
					cols: $('input#cols').val(),
					rows: $('input#rows').val(),
					afterPreload: function (opt) {
						$('button#play').prop('disabled', null);
						$('div#loading-message').html("All images preloaded");
					},
					duringPreload: function (data) {
						var max = parseInt( $('div#loader').css('max-width') );
						var percentage = (data.count / data.total) * max;
						$('div#loader').css('width', percentage+'px');
						$('div#loading-message').html( Math.round( ((100 * data.count) / data.total), 2 ) + "% loaded");
					}
				});
			});
		</script>
	</body>
</html>
